(window.webpackJsonp=window.webpackJsonp||[]).push([[209],{573:function(t,a,s){"use strict";s.r(a);var e=s(40),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("blockquote",[s("p",[t._v("本文最初发表于"),s("a",{attrs:{href:"https://www.cnblogs.com/smyhvae/p/8550195.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("博客园"),s("OutboundLink")],1),t._v("，并在"),s("a",{attrs:{href:"https://github.com/qianguyihao/Web",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub"),s("OutboundLink")],1),t._v("上持续更新"),s("strong",[t._v("前端的系列文章")]),t._v("。欢迎在GitHub上关注我，一起入门和进阶前端。")])]),t._v(" "),s("blockquote",[s("p",[t._v("以下是正文。")])]),t._v(" "),s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),s("p",[t._v("提升页面性能优化的方法有哪些：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("1、资源压缩合并，减少http请求")])]),t._v(" "),s("li",[s("p",[t._v("2、"),s("strong",[t._v("非核心代码异步加载")]),t._v(" --\x3e 异步加载的方式 --\x3e 异步加载的区别")])])]),t._v(" "),s("p",[t._v("如果回答出"),s("code",[t._v("非核心代码异步加载")]),t._v("，就会层层深入。")]),t._v(" "),s("ul",[s("li",[t._v("3、利用浏览器缓存  --\x3e 缓存的分类  --\x3e 缓存的原理")])]),t._v(" "),s("p",[s("strong",[t._v("缓存")]),t._v("是所有性能优化的方式中最重要的一步，这个一定要答好。【重要】")]),t._v(" "),s("p",[t._v("有的人可能会回答local storage 和session storage，其实不是这个。浏览器缓存和存储不是一回事。")]),t._v(" "),s("ul",[s("li",[t._v("4、使用CDN")])]),t._v(" "),s("p",[t._v("浏览器第一次打开页面时，缓存是起不了作用的。CDN这一条，一定要说出来。")]),t._v(" "),s("ul",[s("li",[t._v("5、DNS预解析")])]),t._v(" "),s("h2",{attrs:{id:"一、资源压缩合并-减少http请求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、资源压缩合并-减少http请求"}},[t._v("#")]),t._v(" 一、资源压缩合并，减少http请求")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("合并图片（css sprites）、CSS和JS文件合并、CSS和JS文件压缩")])]),t._v(" "),s("li",[s("p",[t._v("图片较多的页面也可以使用 lazyLoad 等技术进行优化。")])]),t._v(" "),s("li",[s("p",[t._v("精灵图等")])])]),t._v(" "),s("h2",{attrs:{id:"二、非核心代码异步加载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、非核心代码异步加载"}},[t._v("#")]),t._v(" 二、非核心代码异步加载")]),t._v(" "),s("p",[t._v("异步加载的方式：（这里不说框架，只说原理）")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("动态脚本加载")])]),t._v(" "),s("li",[s("p",[t._v("defer")])]),t._v(" "),s("li",[s("p",[t._v("async")])])]),t._v(" "),s("h3",{attrs:{id:"动态脚本加载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#动态脚本加载"}},[t._v("#")]),t._v(" 动态脚本加载")]),t._v(" "),s("p",[t._v("使用document.createElement创建一个script标签，即"),s("code",[t._v("document.createElement('script')")]),t._v("，然后把这个标签加载到body上面去。")]),t._v(" "),s("p",[t._v("参考链接：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.jianshu.com/p/13cf23a90328",target:"_blank",rel:"noopener noreferrer"}},[t._v("javascript 异步加载"),s("OutboundLink")],1),t._v("  动态脚本加载的那部分代码，看不太懂。")])]),t._v(" "),s("h3",{attrs:{id:"defer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#defer"}},[t._v("#")]),t._v(" defer")]),t._v(" "),s("p",[t._v("通过异步的方式加载defer1.js文件：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("./defer1.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("defer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h3",{attrs:{id:"async"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#async"}},[t._v("#")]),t._v(" async")]),t._v(" "),s("blockquote",[s("p",[t._v("HTmL5新增特性。")])]),t._v(" "),s("p",[t._v("通过异步的方式加载async1.js文件：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("./async1.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("async")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("h3",{attrs:{id:"defer和async的区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#defer和async的区别"}},[t._v("#")]),t._v(" defer和async的区别")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("defer：在HTML解析完之后才会执行。如果是多个，则按照加载的顺序依次执行。")])]),t._v(" "),s("li",[s("p",[t._v("async：在加载完之后立即执行。如果是多个，执行顺序和加载顺序无关。")])])]),t._v(" "),s("p",[t._v("代码举例：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token doctype"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),s("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("DOCTYPE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token name"}},[t._v("html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("lang")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("en"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("charset")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("UTF-8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("viewport"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("width=device-width, initial-scale=1.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http-equiv")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("X-UA-Compatible"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("ie=edge"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Document"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--通过异步的方式引入两个外部的js文件--\x3e")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("./defer1.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("defer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("./defer2.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("defer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'同步任务'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("上方打印的结果是：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("同步任务\ndefer1\ndefer2\n")])])]),s("p",[t._v("因为defer的加载是有顺序的，所以两个引入defer文件按顺序执行。如果把引入的文件改为async的方式加载，打印的结果可能是：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("同步任务\nasync2\nasync1\n")])])]),s("p",[t._v("参考链接：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://segmentfault.com/a/1190000006778717",target:"_blank",rel:"noopener noreferrer"}},[t._v("浅谈script标签的defer和async"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"三、利用浏览器缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、利用浏览器缓存"}},[t._v("#")]),t._v(" 三、利用浏览器缓存")]),t._v(" "),s("p",[s("strong",[t._v("缓存")]),t._v("：资源文件（比如图片）在"),s("strong",[t._v("本地的硬盘")]),t._v("里存有副本，浏览器下次请求的时候，可能直接从本地磁盘里读取，而不会重新请求图片的url。")]),t._v(" "),s("p",[t._v("缓存分为：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("强缓存")])]),t._v(" "),s("li",[s("p",[t._v("协商缓存")])])]),t._v(" "),s("h3",{attrs:{id:"强缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#强缓存"}},[t._v("#")]),t._v(" 强缓存")]),t._v(" "),s("p",[s("strong",[t._v("强缓存")]),t._v("：不用请求服务器，直接使用本地的缓存。")]),t._v(" "),s("p",[t._v("强缓存是利用 http 响应头中的**"),s("code",[t._v("Expires")]),s("strong",[t._v("或")]),s("code",[t._v("Cache-Control")]),t._v("**实现的。【重要】")]),t._v(" "),s("p",[t._v("浏览器第一次请求一个资源时，服务器在返回该资源的同时，会把上面这两个属性放在response header中。比如：")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://img.smyhvae.com/20180310_2310.png",alt:""}})]),t._v(" "),s("p",[s("strong",[t._v("注意")]),t._v("：这两个response header属性可以只启用一个，也可以同时启用。当response header中，Expires和Cache-Control同时存在时，"),s("strong",[t._v("Cache-Control的优先级高于Expires")]),t._v("。")]),t._v(" "),s("p",[t._v("下面讲一下二者的区别。")]),t._v(" "),s("p",[s("strong",[t._v("1、"),s("code",[t._v("Expires")])]),t._v("：服务器返回的"),s("strong",[t._v("绝对时间")]),t._v("。")]),t._v(" "),s("p",[t._v("是较老的强缓存管理 response header。浏览器再次请求这个资源时，先从缓存中寻找，找到这个资源后，拿出它的Expires跟当前的请求时间比较，如果请求时间在Expires的时间之前，就能命中缓存，否则就不行。")]),t._v(" "),s("p",[t._v("如果缓存没有命中，浏览器直接从服务器请求资源时，Expires Header在重新请求的时候会被更新。")]),t._v(" "),s("p",[s("strong",[t._v("缺点：")])]),t._v(" "),s("p",[t._v("由于"),s("code",[t._v("Expires")]),t._v("是服务器返回的一个绝对时间，存在的问题是：服务器的事件和客户端的事件可能不一致。在服务器时间与客户端时间相差较大时，缓存管理容易出现问题，比如随意修改客户端时间，就能影响缓存命中的结果。所以，在http1.1中，提出了一个新的response header，就是Cache-Control。")]),t._v(" "),s("p",[s("strong",[t._v("2、"),s("code",[t._v("Cache-Control")])]),t._v("：服务器返回的"),s("strong",[t._v("相对时间")]),t._v("。")]),t._v(" "),s("p",[t._v("http1.1中新增的 response header。浏览器第一次请求资源之后，在接下来的相对时间之内，都可以利用本地缓存。超出这个时间之后，则不能命中缓存。重新请求时，"),s("code",[t._v("Cache-Control")]),t._v("会被更新。")]),t._v(" "),s("h3",{attrs:{id:"协商缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#协商缓存"}},[t._v("#")]),t._v(" 协商缓存")]),t._v(" "),s("p",[s("strong",[t._v("协商缓存")]),t._v("：浏览器发现本地有资源的副本，但是不太确定要不要使用，于是去问问服务器。")]),t._v(" "),s("p",[t._v("当浏览器对某个资源的请求没有命中强缓存（也就是说超出时间了），就会发一个请求到服务器，验证协商缓存是否命中。")]),t._v(" "),s("p",[t._v("协商缓存是利用的是两对Header：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("第一对："),s("code",[t._v("Last-Modified")]),t._v("、"),s("code",[t._v("If-Modified-Since")])])]),t._v(" "),s("li",[s("p",[t._v("第二对："),s("code",[t._v("ETag")]),t._v("、"),s("code",[t._v("If-None-Match")])])])]),t._v(" "),s("p",[t._v("ETag（Entity Tag）：被请求变量的实体值”。")]),t._v(" "),s("p",[s("strong",[t._v("1、"),s("code",[t._v("Last-Modified")]),t._v("、"),s("code",[t._v("If-Modified-Since")])]),t._v("。过程如下：")]),t._v(" "),s("p",[t._v("（1）浏览器第一次请求一个资源，服务器在返回这个资源的同时，会加上"),s("code",[t._v("Last-Modified")]),t._v("这个 response header，这个header表示这该资源在服务器上的最后修改时间：")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://img.smyhvae.com/20180311_1715.png",alt:""}})]),t._v(" "),s("p",[t._v("（2）浏览器再次请求这个资源时，会加上"),s("code",[t._v("If-Modified-Since")]),t._v("这个 request header，这个header的值就是上一次返回的"),s("code",[t._v("Last-Modified")]),t._v("的值：")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://img.smyhvae.com/20180311_1716.png",alt:""}})]),t._v(" "),s("p",[t._v("（3）服务器收到第二次请求时，会比对浏览器传过来的"),s("code",[t._v("If-Modified-Since")]),t._v("和资源在服务器上的最后修改时间"),s("code",[t._v("Last-Modified")]),t._v("，判断资源是否有变化。如果没有变化则返回304 Not Modified，但不返回资源内容（此时，服务器不会返回 Last-Modified 这个 response header）；如果有变化，就正常返回资源内容（继续重复整个流程）。这是服务器返回304时的response header：")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://img.smyhvae.com/20180311_1720.png",alt:""}})]),t._v(" "),s("p",[t._v("（4）浏览器如果收到304的响应，就会从缓存中加载资源。")]),t._v(" "),s("p",[s("strong",[t._v("缺点：")])]),t._v(" "),s("p",[s("code",[t._v("Last-Modified")]),t._v("、"),s("code",[t._v("If-Modified-Since")]),t._v("一般来说都是非常可靠的，但面临的问题是：")]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("服务器上的资源变化了，但是最后的修改时间却没有变化")]),t._v("。")])]),t._v(" "),s("li",[s("p",[t._v("如果服务器端在一秒内修改文件两次，但产生的"),s("code",[t._v("Last-Modified")]),t._v("却只有一个值。")])])]),t._v(" "),s("p",[t._v("这一对header就无法解决这种情况。于是，下面这一对header出场了。")]),t._v(" "),s("p",[s("strong",[t._v("2、"),s("code",[t._v("ETag")]),t._v("、"),s("code",[t._v("If-None-Match")])]),t._v("。过程如下：")]),t._v(" "),s("p",[t._v("（1）浏览器第一次请求一个资源，服务器在返回这个资源的同时，会加上"),s("code",[t._v("ETag")]),t._v("这个 response header，这个header是服务器根据当前请求的资源生成的"),s("strong",[t._v("唯一标识")]),t._v("。这个唯一标识是一个字符串，只要资源有变化这个串就不同，跟最后修改时间无关，所以也就很好地补充了"),s("code",[t._v("Last-Modified")]),t._v("的不足。如下：")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://img.smyhvae.com/20180311_1735.png",alt:""}})]),t._v(" "),s("p",[t._v("（2）浏览器再次请求这个资源时，会加上"),s("code",[t._v("If-None-Match")]),t._v("这个 request header，这个header的值就是上一次返回的"),s("code",[t._v("ETag")]),t._v("的值：")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://img.smyhvae.com/20180311_1737.png",alt:""}})]),t._v(" "),s("p",[t._v("3）服务器第二次请求时，会对比浏览器传过来的"),s("code",[t._v("If-None-Match")]),t._v("和服务器重新生成的一个新的"),s("code",[t._v("ETag")]),t._v("，判断资源是否有变化。如果没有变化则返回304 Not Modified，但不返回资源内容（此时，由于ETag重新生成过，response header中还会把这个ETag返回，即使这个ETag并无变化）。如果有变化，就正常返回资源内容（继续重复整个流程）。这是服务器返回304时的response header：")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://img.smyhvae.com/20180311_1740.png",alt:""}})]),t._v(" "),s("p",[t._v("（4）浏览器如果收到304的响应，就会从缓存中加载资源。")]),t._v(" "),s("p",[t._v("提示：如果面试官问你：与浏览器缓存相关的http header有哪些？你能写出来吗？这是一个亮点。")]),t._v(" "),s("p",[t._v("参考链接：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.cnblogs.com/lyzg/p/5125934.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("浏览器缓存知识小结及应用"),s("OutboundLink")],1),t._v("[荐]")])]),t._v(" "),s("h2",{attrs:{id:"四、使用cdn"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、使用cdn"}},[t._v("#")]),t._v(" 四、使用CDN")]),t._v(" "),s("p",[t._v("怎么最快地让用户请求资源。一方面是让资源在传输的过程中变小，另外就是CDN。")]),t._v(" "),s("p",[t._v("要注意，浏览器第一次打开页面的时候，浏览器缓存是起不了作任何用的，使用CDN，效果就很明显。")]),t._v(" "),s("h2",{attrs:{id:"五、dns预解析-dns-prefetch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、dns预解析-dns-prefetch"}},[t._v("#")]),t._v(" 五、DNS预解析（dns-prefetch）")]),t._v(" "),s("p",[t._v("通过 DNS 预解析来告诉浏览器未来我们可能从某个特定的 URL 获取资源，当浏览器真正使用到该域中的某个资源时就可以尽快地完成 DNS 解析。")]),t._v(" "),s("p",[s("strong",[t._v("第一步")]),t._v("：打开或关闭DNS预解析")]),t._v(" "),s("p",[t._v("你可以通过在服务器端发送 X-DNS-Prefetch-Control 报头。或是在文档中使用值为 http-equiv 的meta标签：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("http-equiv")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("x-dns-prefetch-control"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("on"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("需要说明的是，在一些高级浏览器中，页面中所有的超链接（"),s("code",[t._v("<a>")]),t._v("标签），默认打开了DNS预解析。但是，如果页面中采用的https协议，很多浏览器是默认关闭了超链接的DNS预解析。如果加了上面这行代码，则表明强制打开浏览器的预解析。（如果你能在面试中把这句话说出来，则一定是你出彩的地方）")]),t._v(" "),s("p",[s("strong",[t._v("第二步")]),t._v("：对指定的域名进行DNS预解析")]),t._v(" "),s("p",[t._v("如果我们将来可能从 smyhvae.com 获取图片或音频资源，那么可以在文档顶部的 ")]),s("head",[t._v(" 标签中加入以下内容："),s("p"),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("link")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("rel")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("dns-prefetch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("href")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("http://www.smyhvae.com/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("当我们从该 URL 请求一个资源时，就不再需要等待 DNS 解析的过程。该技术对使用第三方资源特别有用。")]),t._v(" "),s("p",[t._v("参考链接：")]),t._v(" "),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"http://bubkoo.com/2015/11/19/prefetching-preloading-prebrowsing/",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端性能优化 - 资源预加载"),s("OutboundLink")],1),t._v("[荐]")])]),t._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://www.xuanfengge.com/dns-prefetching-analysis.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("DNS预解析详解"),s("OutboundLink")],1)])])]),t._v(" "),s("h2",{attrs:{id:"我的公众号"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#我的公众号"}},[t._v("#")]),t._v(" 我的公众号")]),t._v(" "),s("p",[t._v("想学习"),s("font",{attrs:{color:"#0000ff"}},[s("strong",[t._v("代码之外的技能")])]),t._v("？不妨关注我的微信公众号："),s("strong",[t._v("千古壹号")]),t._v("（id："),s("code",[t._v("qianguyihao")]),t._v("）。")],1),t._v(" "),s("p",[t._v("扫一扫，你将发现另一个全新的世界，而这将是一场美丽的意外：")]),t._v(" "),s("p",[s("img",{attrs:{src:"http://img.smyhvae.com/2016040102.jpg",alt:""}})])])])}),[],!1,null,null,null);a.default=n.exports}}]);